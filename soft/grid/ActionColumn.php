<?php/** * @copyright Copyright &copy; Shukurullo Odilov,  2020 * @package yii2-custom-soft (Odilov) * @version 1.0.0 */namespace soft\grid;use soft\helpers\ArrayHelper;use Yii;use kartik\grid\ActionColumn as KartikActionColumn;use yii\helpers\Html;use yii\helpers\Url;class ActionColumn extends KartikActionColumn{    /**     * Buttonlar uchun url generatsiya qilishda ishlatish mumkin     * Qiymat sifatida string, array yoki callable function berish mumkin     *     * Usage:     *     * 'urls' =>  [     *      'delete' => function($action, $model, $key, $index, $widget){                return ... ;     *       },     *       'download' => ['download'],     *      ...     * ]     *     * @var array     */    public $urls = [];    /**     * @inheritdoc     */    public $vAlign = 'middle';//	public $dropdown = true;    /**     * @inheritDoc     */    public function init()    {        $this->normalizeButtonOptions();        parent::init();    }    /**     * Qo'shimcha ravisgda $this->urls[] parametrini tekshiradi     * Agar shu massiv ichida berilgan $action dagi qiymat topilsa, shu elementning url qimatini qaytaradi     * Aks holda parent methodi ishga tushadi     * @see urls     * @param string $action     * @param \yii\db\ActiveRecordInterface $model     * @param mixed $key     * @param int $index     * @return false|mixed|string     */    public function createUrl($action, $model, $key, $index)	{		if (isset($this->urls[$action]) ) {            if(is_callable($this->urls[$action])){                return call_user_func($this->urls[$action], $action, $model, $key, $index, $this);            }            return Url::to($this->urls[$action]);		}		return parent::createUrl($action, $model, $key, $index);	}    public function normalizeButtonOptions()    {        $this->viewOptions = ArrayHelper::merge($this->defaultViewOptions(), $this->viewOptions);        $this->updateOptions = ArrayHelper::merge($this->defaultUpdateOptions(), $this->updateOptions);        $this->deleteOptions = ArrayHelper::merge($this->defaultDeleteOptions(), $this->deleteOptions);        if (isset($this->deleteOptions['role'])){            $value = $this->deleteOptions['role'];            if ($value == 'modal-remote'){                $this->deleteOptions['data-confirm'] = false;                $this->deleteOptions['data-method'] = false;                $this->deleteOptions['data-request-method'] = 'post';                $this->deleteOptions['data-confirm-title'] = "Tasdiqlaysizmi?";                $this->deleteOptions['data-confirm-message'] = "Siz rostdan ham ushbu elementni o'chirishni xoxlaysizmi?";                Yii::$app->view->registerAjaxCrudAssets();            }            else{                if (empty($value)){                    unset($this->deleteOptions['role']);                }            }        }	}    /**     * View buttoni uchun default holatdagi optionlar     * Bu optionlar $this->viewOptions ga merge qilib yuboriladi     * @see viewOptions     * @return array     */    public function defaultViewOptions()    {        $text = Yii::t('site', "View");        $icon = "<i class='fa fa-eye'></i>";        return [            'title'=> $text,            'label'=> $this->dropdown ? $icon." ".$text : null,            'data-toggle'=>'tooltip',        ];	}	/**     * Update buttoni uchun default holatdagi optionlar     * Bu optionlar $this->updateOptions ga merge qilib yuboriladi     * @see updateOptions     * @return array     */    public function defaultUpdateOptions()    {        $text = Yii::t('site', "Update");        $icon = "<i class='fa fa-edit'></i>";        return [            'title'=> $text,            'label'=> $this->dropdown ? $icon." ".$text : null,            'data-toggle'=>'tooltip',        ];	}	/**     * Delete buttoni uchun default holatdagi optionlar     * Bu optionlar $this->deleteOptions ga merge qilib yuboriladi     * @see deleteOptions     * @return array     */    public function defaultDeleteOptions()    {        $text = Yii::t('site', "Delete");        $icon = "<i class='fa fa-trash-alt'></i>";        return [            'title'=> $text,            'label'=> $this->dropdown ? $icon." ".$text : null,            'data-toggle'=>'tooltip',            'data-pjax' => 0,            'role' => 'modal-remote',            'data-confirm'=> "Siz rostdan ham ushbu elementni o'chirishni xoxlaysizmi?",        ];	}}